<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QC Management System</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>MSI 90 INOCULATION SYSTEM CHECKLIST</h1>
    <p><a href="fbq03.html" class="btn">Go to QF 07 FBQ - 03 Form</a></p>
    <p><a href="index.html" class="btn btn-secondary">Back to Main Menu</a></p>

    <div id="current-component">
      <h3>Current Component: <span id="selected-component-display">None selected</span></h3>
      <button id="change-component" class="btn">Change</button>
    </div>

    <!-- Modal for product search -->
    <div id="product-modal" style="display:none; position:fixed; z-index:1; left:0; top:0; width:100%; height:100%; overflow:auto; background-color: rgba(0,0,0,0.4);">
      <div class="modal-content" style="background-color:#fefefe; margin:15% auto; padding:20px; border:1px solid #888; width:80%;">
        <span class="close" style="color:#aaa; float:right; font-size:28px; font-weight:bold; cursor:pointer;">&times;</span>
        <input type="text" id="modal-search" placeholder="Search product code..." style="width:100%; padding:12px; border:1px solid #ccc; border-radius:4px;">
        <div id="modal-results"></div>
      </div>
    </div>

    <form id="qc-form">
      <input type="hidden" id="selected-component">

      <h3>Hourly Measurements</h3>
      <div class="grid">
        <div class="form-group">
          <label>Inoculation Flow Rate Setting (gms/sec):</label>
          <input type="number" step="0.01" id="flow-rate-setting" required>
        </div>

        <div class="form-group">
          <label>Inoculation Flow Rate Display Value ±10% (gms/sec):</label>
          <input type="number" step="0.01" id="flow-rate-display" required>
        </div>

        <div class="form-group">
          <label>Hot Box Temp 25-30°C:</label>
          <input type="number" step="0.01" id="hot-box-temp" required>
          <span class="error" id="hotboxtemerror"></span>
        </div>

        <div class="form-group">
          <label>Air Pressure 4.5-8.0 bar:</label>
          <input type="number" step="0.01" id="air-pressure" required>
          <span class="error" id="airPressureError"></span>
        </div>

        <div class="form-group">
          <label>Inject Pressure 1-2 bar:</label>
          <input type="number" step="0.01" id="inject-pressure" required>
          <span class="error" id="injectPressureError"></span>
        </div>

        <div class="form-group">
          <label>Feed Pipe Condition:</label>
          <textarea id="feed-pipe" required></textarea>
        </div>
      </div>

      <h3>Powder Measurements</h3>
      <div class="grid">
        <div class="form-group">
          <label>Powder Size (mm):</label>
          <input type="number" step="0.01" id="powder-size">
        </div>

        <div class="form-group">
          <label>Moisture (%):</label>
          <input type="number" step="0.01" id="moisture">
        </div>

        <div class="form-group checkbox">
          <input type="checkbox" id="is-new-bag">
          <label>New Bag Installed</label>
        </div>
      </div>

      <h3>Daily Checks</h3>
      <div class="grid">
        <div class="form-group">
          <label>Hourly Timestamp:</label>
          <input type="datetime-local" id="hourly-time">
        </div>

        <script>
            function updateHourlyTimestamp() {
            const hourlyTimeInput = document.getElementById("hourly-time");
            const now = new Date();

            // Format date & time as yyyy-MM-ddTHH:mm
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');

            hourlyTimeInput.value = `${year}-${month}-${day}T${hours}:${minutes}`;
            }

            // Run when the page loads
            document.addEventListener("DOMContentLoaded", function () {
            updateHourlyTimestamp();
            // Update every 60 seconds (60000 ms)
            setInterval(updateHourlyTimestamp, 60000);
            });
        </script>

        <div class="form-group checkbox">
          <input type="checkbox" id="air-drier">
          <label>Air Drier Functioning</label>
        </div>

        <div class="form-group checkbox">
          <input type="checkbox" id="filter-cleaning">
          <label>Filter Cleaning Done</label>
        </div>

        <div class="form-group">
          <label>Gauge Test (±10%):</label>
          <input type="number" step="0.01" id="gauge-test">
        </div>
      </div>

      <button type="submit">Submit QC Data</button>
    </form>

    <h2>Previous Records</h2>
   <table>
    <thead>
      <tr>
        <th>Time</th>
        <th>Component</th>
        <th>Flow Rate (A / B)</th>
        <th>Hot Box Temp</th>
        <th>Air / Inject Pressure</th>
        <th>Feed Pipe</th>
        <th>Powder Size</th>
        <th>Moisture</th>
        <th>New Bag</th>
        <th>Air Drier</th>
        <th>Filter Cleaning</th>
        <th>Gauge Test</th>
      </tr>
    </thead>
    <tbody id="recordsTableBody">
      <!-- Data from JS will go here -->
    </tbody>
  </table>

  </div>

  <script src="app.js"></script>
</body>
</html>
